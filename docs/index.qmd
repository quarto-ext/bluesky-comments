---
title: "Bluesky Comments Extension"
format:
  html:
    toc: false
---

> Enable Bluesky social discussions in your Quarto documents

Bluesky Comments is a Quarto shortcode extension that seamlessly integrates Bluesky post comments into your documents. This extension dynamically fetches and displays threaded conversations from Bluesky, creating an interactive bridge between your content and social discussions.

As an example, let's use the following [Bluesky post](https://bsky.app/profile/coatless.bsky.social/post/3lbtwdydxrk26). Feel free to join the conversation by commenting on the post - your comment will appear below when you refresh the page!

{{< bluesky-comments at://did:plc:fgeozid7uyx2lfz3yo7zvm3b/app.bsky.feed.post/3lbtwdydxrk26 >}}

## Installation

You can install this extension using Quarto's extension management system:

```bash
quarto add quarto-ext/bluesky-comments
```

This will install the extension under the `_extensions` directory of your Quarto project.

### Requirements

- Quarto version 1.5.0 or higher
- A web browser with JavaScript enabled

## Usage

To embed comments from a Bluesky post, use the `bluesky-comments` shortcode in your Quarto document, replacing `post_url` with the link to the Bluesky post that serves as the start of your comments.

````markdown
{{{< bluesky-comments post_url >}}}
````

Here's the shortcode we used in the example above:

````markdown
{{{< bluesky-comments https://bsky.app/profile/coatless.bsky.social/post/3lbtwdydxrk26 >}}}
````

Alternatively, you can add your Bluesky profile handle to your document's YAML frontmatter (or in the `_quarto.yml` configuration file). Then you can just use the post's record key (the identifier at the end of the URL):

````markdown
---
bluesky-comments:
  profile: coatless.bsky.social
---

{{{< bluesky-comments 3lbtwdydxrk26 >}}}
````

### Durable Bluesky post links

Post record keys never change on Bluesky, but user handles may.
If you change your Bluesky handle in the future (or if you link to a post by someone else and _they_ update their handle), your comments may break.

To avoid breakage, you have a few choices:

1. Use the full [AT Protocol URL](qbluesky-comments-faq.qmd#convert-to-atproto-uri) for the post. Anywhere that `{{{< bluesky-comments >}}}` takes a post URL, it also accepts an `at://` atproto URI.

2. Set your `bluesky-comments.profile` to the [Decentralized Identifier](qbluesky-comments-faq.qmd#convert-to-atproto-uri) (DID) for your profile and use only the post record key in the shortcode:

   ````markdow
   ---
   bluesky-comments:
     profile: did:plc:fgeozid7uyx2lfz3yo7zvm3b  # coatless.bsky.social
   ---

   {{{< bluesky-comments 3lbtwdydxrk26 >}}}
   ````

3. Or you can use your profile URL, knowing that if you change it in the future you may need to update your site again.


## Configuration

The extension can be configured through your document's YAML frontmatter or the `_quarto.yml` configuration file. Add configuration options under the `bluesky-comments` key:

```yaml
---
title: "My Document"
bluesky-comments:
  profile: did:plc:fgeozid7uyx2lfz3yo7zvm3b  # coatless.bsky.social
  mute-patterns:
    - "ðŸ“Œ"
    - "ðŸ”¥"
    - "/\\bspam\\b/i"  # regex pattern
  mute-users:
    - "did:plc:1234abcd"
  filter-empty-replies: true
  visible-comments: 3
  visible-subcomments: 3
---
```

### Available Options

- `profile`: A string with the user profile as a handle or [decentralized identifier](qbluesky-comments-faq.qmd#convert-to-atproto-uri)
- `mute-patterns`: An array of strings or regex patterns (enclosed in `/`) to filter out comments containing specific text
- `mute-users`: An array of Bluesky DIDs to filter out comments from specific users
- `filter-empty-replies`: Boolean flag to filter out empty or very short replies (default: `true`)
- `visible-comments`: Number of top-level comments to show initially (default: `3`)
- `visible-subcomments`: Number of replies to show initially under each comment (default: `3`)

Users can click "Show more" buttons to reveal additional comments and replies beyond these initial limits. Filtered comments are counted and displayed at the top of the comments section to maintain transparency about moderation.

## Styling

Modify the extension's appearance by overriding CSS classes in:

```defaults
_extensions/bluesky-comments/styles.css
```

## Limitations

- Only works in HTML output formats with JavaScript enabled
- Subject to Bluesky's API rate limits and availability

## Acknowledgements

This extension builds upon the innovative work of:

- [Emily Liu](https://emilyliu.me/blog/comments) - [Original concept](https://bsky.app/profile/emilyliu.me/post/3lbqta5lnck2i)
- [Samuel Newman](https://bsky.app/profile/samuel.bsky.team) - [Implementation details](https://graysky.app/blog/2024-02-05-adding-blog-comments)
